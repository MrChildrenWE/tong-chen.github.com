---
title: 基因表达热图制作
author: 悟道
layout: post
permalink: /?p=392
categories:
  - R
tags:
  - heatmap
  - R
---
<table>
  <tr cellpadding=0><td>
    热度:
  </td><td cellpadding=0><img src='http://210.75.224.29/wordpress/wp-content/plugins/statpresscn/images/sun.gif' width=10 height=10 border=0 /></td><td cellpadding=0><img src='http://210.75.224.29/wordpress/wp-content/plugins/statpresscn/images/sun.gif' width=10 height=10 border=0 /></td><td cellpadding=0><img src='http://210.75.224.29/wordpress/wp-content/plugins/statpresscn/images/sun.gif' width=10 height=10 border=0 /></td><td cellpadding=0><img src='http://210.75.224.29/wordpress/wp-content/plugins/statpresscn/images/sun_dark.gif' width=10 height=10 border=0 /></td><td cellpadding=0><img src='http://210.75.224.29/wordpress/wp-content/plugins/statpresscn/images/sun_dark.gif' width=10 height=10 border=0 /></td></tr>
</table>

使用R  
首先安装heatmap.2

<div class="wp_codebox">
  <table>
    <tr id="p39212">
      <td class="code" id="p392code12">
        <pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">source</span><span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"http://bioconductor.org/biocLite.R"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
biocLite<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"gplots"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #666666; font-style: italic;">#get heatmap.2</span></pre>
      </td>
    </tr>
  </table>
</div>

然后使用下面的程序

<div class="wp_codebox">
  <table>
    <tr id="p39213">
      <td class="code" id="p392code13">
        <pre class="bash" style="font-family:monospace;">data1 = read.table<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">'ERzero_4cells'</span>, <span style="color: #007800;">header</span>=TRUE, <span style="color: #007800;">sep</span>=<span style="color: #ff0000;">"<span style="color: #000099; font-weight: bold;">\t</span>"</span>,row.names=<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#header=TRUE 表示有第一行标题行， row.names=1表示用第一列作为行名称</span>
x</pre>
      </td>
    </tr>
  </table>
</div>

[<img class="alignnone size-medium wp-image-1108" title="Screenshot-4" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-41-300x234.png" alt="" width="300" height="234" />][1]

详细的解释[heatmap.2][2]

还有一点很重要的参考资料，可以解决更多的问题和疑惑[gplots document][3]，这是后来发现的。

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;

**  
再深入一些**

1.测试以下数据的前提（数据包含在R分发包，敲入即可直接使用）：

<div class="wp_codebox">
  <table>
    <tr id="p39214">
      <td class="code" id="p392code14">
        <pre class="bash" style="font-family:monospace;">data<span style="color: #7a0874; font-weight: bold;">&#40;</span>mtcars<span style="color: #7a0874; font-weight: bold;">&#41;</span>
x</pre>
      </td>
    </tr>
  </table>
</div>

x的数据内容是：  


## heatma-data

<table class="wptable rowstyle-alt" id="wptable-4"  cellspacing="1">
  <tr>
    <td style="width:30px" >
      &nbsp;
    </td>
    
    <th class="sortable" style="width:30px" align="right">
      mpg
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      cyl
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      disp
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      hp
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      drat
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      wt
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      qsec
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      vs
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      am
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      gear
    </th>
    
    <th class="sortable" style="width:30px" align="right">
      carb
    </th>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Mazda RX4
    </td>
    
    <td style="width:30px" align="right">
      21
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      160
    </td>
    
    <td style="width:30px" align="right">
      110
    </td>
    
    <td style="width:30px" align="right">
      3.9
    </td>
    
    <td style="width:30px" align="right">
      2.62
    </td>
    
    <td style="width:30px" align="right">
      16.46
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Mazda RX4 Wag
    </td>
    
    <td style="width:30px" align="right">
      21
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      160
    </td>
    
    <td style="width:30px" align="right">
      110
    </td>
    
    <td style="width:30px" align="right">
      3.9
    </td>
    
    <td style="width:30px" align="right">
      2.875
    </td>
    
    <td style="width:30px" align="right">
      17.02
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Datsun 710
    </td>
    
    <td style="width:30px" align="right">
      22.8
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      108
    </td>
    
    <td style="width:30px" align="right">
      93
    </td>
    
    <td style="width:30px" align="right">
      3.85
    </td>
    
    <td style="width:30px" align="right">
      2.32
    </td>
    
    <td style="width:30px" align="right">
      18.61
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Hornet 4 Drive
    </td>
    
    <td style="width:30px" align="right">
      21.4
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      258
    </td>
    
    <td style="width:30px" align="right">
      110
    </td>
    
    <td style="width:30px" align="right">
      3.08
    </td>
    
    <td style="width:30px" align="right">
      3.215
    </td>
    
    <td style="width:30px" align="right">
      19.44
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Hornet Sportabout
    </td>
    
    <td style="width:30px" align="right">
      18.7
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      360
    </td>
    
    <td style="width:30px" align="right">
      175
    </td>
    
    <td style="width:30px" align="right">
      3.15
    </td>
    
    <td style="width:30px" align="right">
      3.44
    </td>
    
    <td style="width:30px" align="right">
      17.02
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Valiant
    </td>
    
    <td style="width:30px" align="right">
      18.1
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      225
    </td>
    
    <td style="width:30px" align="right">
      105
    </td>
    
    <td style="width:30px" align="right">
      2.76
    </td>
    
    <td style="width:30px" align="right">
      3.46
    </td>
    
    <td style="width:30px" align="right">
      20.22
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Duster 360
    </td>
    
    <td style="width:30px" align="right">
      14.3
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      360
    </td>
    
    <td style="width:30px" align="right">
      245
    </td>
    
    <td style="width:30px" align="right">
      3.21
    </td>
    
    <td style="width:30px" align="right">
      3.57
    </td>
    
    <td style="width:30px" align="right">
      15.84
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Merc 240D
    </td>
    
    <td style="width:30px" align="right">
      24.4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      146.7
    </td>
    
    <td style="width:30px" align="right">
      62
    </td>
    
    <td style="width:30px" align="right">
      3.69
    </td>
    
    <td style="width:30px" align="right">
      3.19
    </td>
    
    <td style="width:30px" align="right">
      20
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Merc 230
    </td>
    
    <td style="width:30px" align="right">
      22.8
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      140.8
    </td>
    
    <td style="width:30px" align="right">
      95
    </td>
    
    <td style="width:30px" align="right">
      3.92
    </td>
    
    <td style="width:30px" align="right">
      3.15
    </td>
    
    <td style="width:30px" align="right">
      22.9
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Merc 280
    </td>
    
    <td style="width:30px" align="right">
      19.2
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      167.6
    </td>
    
    <td style="width:30px" align="right">
      123
    </td>
    
    <td style="width:30px" align="right">
      3.92
    </td>
    
    <td style="width:30px" align="right">
      3.44
    </td>
    
    <td style="width:30px" align="right">
      18.3
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Merc 280C
    </td>
    
    <td style="width:30px" align="right">
      17.8
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      167.6
    </td>
    
    <td style="width:30px" align="right">
      123
    </td>
    
    <td style="width:30px" align="right">
      3.92
    </td>
    
    <td style="width:30px" align="right">
      3.44
    </td>
    
    <td style="width:30px" align="right">
      18.9
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Merc 450SE
    </td>
    
    <td style="width:30px" align="right">
      16.4
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      275.8
    </td>
    
    <td style="width:30px" align="right">
      180
    </td>
    
    <td style="width:30px" align="right">
      3.07
    </td>
    
    <td style="width:30px" align="right">
      4.07
    </td>
    
    <td style="width:30px" align="right">
      17.4
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Merc 450SL
    </td>
    
    <td style="width:30px" align="right">
      17.3
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      275.8
    </td>
    
    <td style="width:30px" align="right">
      180
    </td>
    
    <td style="width:30px" align="right">
      3.07
    </td>
    
    <td style="width:30px" align="right">
      3.73
    </td>
    
    <td style="width:30px" align="right">
      17.6
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Merc 450SLC
    </td>
    
    <td style="width:30px" align="right">
      15.2
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      275.8
    </td>
    
    <td style="width:30px" align="right">
      180
    </td>
    
    <td style="width:30px" align="right">
      3.07
    </td>
    
    <td style="width:30px" align="right">
      3.78
    </td>
    
    <td style="width:30px" align="right">
      18
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Cadillac Fleetwood
    </td>
    
    <td style="width:30px" align="right">
      10.4
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      472
    </td>
    
    <td style="width:30px" align="right">
      205
    </td>
    
    <td style="width:30px" align="right">
      2.93
    </td>
    
    <td style="width:30px" align="right">
      5.25
    </td>
    
    <td style="width:30px" align="right">
      17.98
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Lincoln Continental
    </td>
    
    <td style="width:30px" align="right">
      10.4
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      460
    </td>
    
    <td style="width:30px" align="right">
      215
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      5.424
    </td>
    
    <td style="width:30px" align="right">
      17.82
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Chrysler Imperial
    </td>
    
    <td style="width:30px" align="right">
      14.7
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      440
    </td>
    
    <td style="width:30px" align="right">
      230
    </td>
    
    <td style="width:30px" align="right">
      3.23
    </td>
    
    <td style="width:30px" align="right">
      5.345
    </td>
    
    <td style="width:30px" align="right">
      17.42
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Fiat 128
    </td>
    
    <td style="width:30px" align="right">
      32.4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      78.7
    </td>
    
    <td style="width:30px" align="right">
      66
    </td>
    
    <td style="width:30px" align="right">
      4.08
    </td>
    
    <td style="width:30px" align="right">
      2.2
    </td>
    
    <td style="width:30px" align="right">
      19.47
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Honda Civic
    </td>
    
    <td style="width:30px" align="right">
      30.4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      75.7
    </td>
    
    <td style="width:30px" align="right">
      52
    </td>
    
    <td style="width:30px" align="right">
      4.93
    </td>
    
    <td style="width:30px" align="right">
      1.615
    </td>
    
    <td style="width:30px" align="right">
      18.52
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Toyota Corolla
    </td>
    
    <td style="width:30px" align="right">
      33.9
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      71.1
    </td>
    
    <td style="width:30px" align="right">
      65
    </td>
    
    <td style="width:30px" align="right">
      4.22
    </td>
    
    <td style="width:30px" align="right">
      1.835
    </td>
    
    <td style="width:30px" align="right">
      19.9
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Toyota Corona
    </td>
    
    <td style="width:30px" align="right">
      21.5
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      120.1
    </td>
    
    <td style="width:30px" align="right">
      97
    </td>
    
    <td style="width:30px" align="right">
      3.7
    </td>
    
    <td style="width:30px" align="right">
      2.465
    </td>
    
    <td style="width:30px" align="right">
      20.01
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Dodge Challenger
    </td>
    
    <td style="width:30px" align="right">
      15.5
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      318
    </td>
    
    <td style="width:30px" align="right">
      150
    </td>
    
    <td style="width:30px" align="right">
      2.76
    </td>
    
    <td style="width:30px" align="right">
      3.52
    </td>
    
    <td style="width:30px" align="right">
      16.87
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      AMC Javelin
    </td>
    
    <td style="width:30px" align="right">
      15.2
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      304
    </td>
    
    <td style="width:30px" align="right">
      150
    </td>
    
    <td style="width:30px" align="right">
      3.15
    </td>
    
    <td style="width:30px" align="right">
      3.435
    </td>
    
    <td style="width:30px" align="right">
      17.3
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Camaro Z28
    </td>
    
    <td style="width:30px" align="right">
      13.3
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      350
    </td>
    
    <td style="width:30px" align="right">
      245
    </td>
    
    <td style="width:30px" align="right">
      3.73
    </td>
    
    <td style="width:30px" align="right">
      3.84
    </td>
    
    <td style="width:30px" align="right">
      15.41
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Pontiac Firebird
    </td>
    
    <td style="width:30px" align="right">
      19.2
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      400
    </td>
    
    <td style="width:30px" align="right">
      175
    </td>
    
    <td style="width:30px" align="right">
      3.08
    </td>
    
    <td style="width:30px" align="right">
      3.845
    </td>
    
    <td style="width:30px" align="right">
      17.05
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      3
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Fiat X1-9
    </td>
    
    <td style="width:30px" align="right">
      27.3
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      79
    </td>
    
    <td style="width:30px" align="right">
      66
    </td>
    
    <td style="width:30px" align="right">
      4.08
    </td>
    
    <td style="width:30px" align="right">
      1.935
    </td>
    
    <td style="width:30px" align="right">
      18.9
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Porsche 914-2
    </td>
    
    <td style="width:30px" align="right">
      26
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      120.3
    </td>
    
    <td style="width:30px" align="right">
      91
    </td>
    
    <td style="width:30px" align="right">
      4.43
    </td>
    
    <td style="width:30px" align="right">
      2.14
    </td>
    
    <td style="width:30px" align="right">
      16.7
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      5
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Lotus Europa
    </td>
    
    <td style="width:30px" align="right">
      30.4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      95.1
    </td>
    
    <td style="width:30px" align="right">
      113
    </td>
    
    <td style="width:30px" align="right">
      3.77
    </td>
    
    <td style="width:30px" align="right">
      1.513
    </td>
    
    <td style="width:30px" align="right">
      16.9
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      5
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Ford Pantera L
    </td>
    
    <td style="width:30px" align="right">
      15.8
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      351
    </td>
    
    <td style="width:30px" align="right">
      264
    </td>
    
    <td style="width:30px" align="right">
      4.22
    </td>
    
    <td style="width:30px" align="right">
      3.17
    </td>
    
    <td style="width:30px" align="right">
      14.5
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      5
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Ferrari Dino
    </td>
    
    <td style="width:30px" align="right">
      19.7
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
    
    <td style="width:30px" align="right">
      145
    </td>
    
    <td style="width:30px" align="right">
      175
    </td>
    
    <td style="width:30px" align="right">
      3.62
    </td>
    
    <td style="width:30px" align="right">
      2.77
    </td>
    
    <td style="width:30px" align="right">
      15.5
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      5
    </td>
    
    <td style="width:30px" align="right">
      6
    </td>
  </tr>
  
  <tr>
    <td style="width:30px" align="right">
      Maserati Bora
    </td>
    
    <td style="width:30px" align="right">
      15
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
    
    <td style="width:30px" align="right">
      301
    </td>
    
    <td style="width:30px" align="right">
      335
    </td>
    
    <td style="width:30px" align="right">
      3.54
    </td>
    
    <td style="width:30px" align="right">
      3.57
    </td>
    
    <td style="width:30px" align="right">
      14.6
    </td>
    
    <td style="width:30px" align="right">
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      5
    </td>
    
    <td style="width:30px" align="right">
      8
    </td>
  </tr>
  
  <tr class="alt">
    <td style="width:30px" align="right">
      Volvo 142E
    </td>
    
    <td style="width:30px" align="right">
      21.4
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      121
    </td>
    
    <td style="width:30px" align="right">
      109
    </td>
    
    <td style="width:30px" align="right">
      4.11
    </td>
    
    <td style="width:30px" align="right">
      2.78
    </td>
    
    <td style="width:30px" align="right">
      18.6
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      1
    </td>
    
    <td style="width:30px" align="right">
      4
    </td>
    
    <td style="width:30px" align="right">
      2
    </td>
  </tr>
</table>



测试及解释

1.不改变列的顺序（不对列聚类）时使用**Colv=FALSE**，不改变行的顺序时使用**Rowv=FALSE**。两个都为FALSE时，应加上dendrogram=&#8221;none&#8221;，不然会发生警告，但不影响结果.

2.存储热图的返回值

<div class="wp_codebox">
  <table>
    <tr id="p39215">
      <td class="code" id="p392code15">
        <pre class="bash" style="font-family:monospace;">hv</pre>
      </td>
    </tr>
  </table>
</div>

**names(hv)** 返回对象的名字，可以使用**hv$rowInd**取得对应的值

<div class="wp_codebox">
  <table>
    <tr id="p39216">
      <td class="code" id="p392code16">
        <pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #ff0000;">"rowInd"</span>        <span style="color: #ff0000;">"colInd"</span>        <span style="color: #ff0000;">"call"</span>          <span style="color: #ff0000;">"colMeans"</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">5</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #ff0000;">"colSDs"</span>        <span style="color: #ff0000;">"carpet"</span>        <span style="color: #ff0000;">"rowDendrogram"</span> <span style="color: #ff0000;">"colDendrogram"</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">9</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #ff0000;">"breaks"</span>        <span style="color: #ff0000;">"col"</span>           <span style="color: #ff0000;">"vline"</span>         <span style="color: #ff0000;">"colorTable"</span></pre>
      </td>
    </tr>
  </table>
</div>

**hv$colInd** 【返回列的索引（从左至右），即原数据中第2列在图的第1列，原数据第9列在图第2列，以此类推】

<div class="wp_codebox">
  <table>
    <tr id="p39217">
      <td class="code" id="p392code17">
        <pre class="bash" style="font-family:monospace;"><span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>  <span style="color: #000000;">2</span>  <span style="color: #000000;">9</span>  <span style="color: #000000;">8</span> <span style="color: #000000;">11</span>  <span style="color: #000000;">6</span>  <span style="color: #000000;">5</span> <span style="color: #000000;">10</span>  <span style="color: #000000;">7</span>  <span style="color: #000000;">1</span>  <span style="color: #000000;">4</span>  <span style="color: #000000;">3</span></pre>
      </td>
    </tr>
  </table>
</div>

hv$rowInd 【返回行的索引（**由下至上**），即原数据中第31行在图的第1行，原数据第17行在图第2行，以此类推】

<div class="wp_codebox">
  <table>
    <tr id="p39218">
      <td class="code" id="p392code18">
        <pre class="bash" style="font-family:monospace;"> <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">31</span> <span style="color: #000000;">17</span> <span style="color: #000000;">16</span> <span style="color: #000000;">15</span>  <span style="color: #000000;">5</span> <span style="color: #000000;">25</span> <span style="color: #000000;">29</span> <span style="color: #000000;">24</span>  <span style="color: #000000;">7</span>  <span style="color: #000000;">6</span>  <span style="color: #000000;">4</span> <span style="color: #000000;">23</span> <span style="color: #000000;">22</span> <span style="color: #000000;">14</span> <span style="color: #000000;">12</span> <span style="color: #000000;">13</span> <span style="color: #000000;">19</span> <span style="color: #000000;">20</span> <span style="color: #000000;">26</span> <span style="color: #000000;">18</span> <span style="color: #000000;">30</span>  <span style="color: #000000;">8</span>  <span style="color: #000000;">1</span>  <span style="color: #000000;">2</span> <span style="color: #000000;">11</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">26</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">10</span> <span style="color: #000000;">28</span>  <span style="color: #000000;">9</span> <span style="color: #000000;">32</span>  <span style="color: #000000;">3</span> <span style="color: #000000;">27</span> <span style="color: #000000;">21</span></pre>
      </td>
    </tr>
  </table>
</div>

根据以上两个变量，就可以**截取热图中任意一部分区域**。可以通过数起始的行或列，然后提取实际对应的行或列，重新做图。

比如想取出前11行和前4列的区域（注意是左下角的区域，而不是左上角【注释掉的部分】）。

<div class="wp_codebox">
  <table>
    <tr id="p39219">
      <td class="code" id="p392code19">
        <pre class="bash" style="font-family:monospace;">rowI</pre>
      </td>
    </tr>
  </table>
</div>

[<img class="alignnone size-medium wp-image-1109" title="Screenshot-5" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-5-300x265.png" alt="" width="300" height="265" />][4]

另外可以使用

<div class="wp_codebox">
  <table>
    <tr id="p39220">
      <td class="code" id="p392code20">
        <pre class="bash" style="font-family:monospace;">plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv<span style="color: #007800;">$rowDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span></pre>
      </td>
    </tr>
  </table>
</div>

和

<div class="wp_codebox">
  <table>
    <tr id="p39221">
      <td class="code" id="p392code21">
        <pre class="bash" style="font-family:monospace;">plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv<span style="color: #007800;">$colDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span></pre>
      </td>
    </tr>
  </table>
</div>

来获得列或行的聚类图。

[<img class="alignnone size-medium wp-image-1110" title="Screenshot-6" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-6-300x225.png" alt="" width="300" height="225" />][5]

**hv$carpet**可以获得按列或行标准化之后的数据。

**hv$colorTable**设定了颜色对应的元素值范围，如果想获得某个颜色对应的元素，可以利用这个。  
下面是取出颜色位白色的的区域代表的值，第一次取出的是值，第二次取出的是索引，第三个把索引转换为二维标记。

<div class="wp_codebox">
  <table>
    <tr id="p39222">
      <td class="code" id="p392code22">
        <pre class="bash" style="font-family:monospace;">y  hv<span style="color: #007800;">$colorTable</span>
          low       high   color
<span style="color: #000000;">1</span>  -<span style="color: #000000;">3.2116766</span> -<span style="color: #000000;">2.7834531</span> <span style="color: #666666; font-style: italic;">#0000FF</span>
<span style="color: #000000;">2</span>  -<span style="color: #000000;">2.7834531</span> -<span style="color: #000000;">2.3552295</span> <span style="color: #666666; font-style: italic;">#2424FF</span>
<span style="color: #000000;">3</span>  -<span style="color: #000000;">2.3552295</span> -<span style="color: #000000;">1.9270060</span> <span style="color: #666666; font-style: italic;">#4949FF</span>
<span style="color: #000000;">4</span>  -<span style="color: #000000;">1.9270060</span> -<span style="color: #000000;">1.4987824</span> <span style="color: #666666; font-style: italic;">#6D6DFF</span>
<span style="color: #000000;">5</span>  -<span style="color: #000000;">1.4987824</span> -<span style="color: #000000;">1.0705589</span> <span style="color: #666666; font-style: italic;">#9292FF</span>
<span style="color: #000000;">6</span>  -<span style="color: #000000;">1.0705589</span> -<span style="color: #000000;">0.6423353</span> <span style="color: #666666; font-style: italic;">#B6B6FF</span>
<span style="color: #000000;">7</span>  -<span style="color: #000000;">0.6423353</span> -<span style="color: #000000;">0.2141118</span> <span style="color: #666666; font-style: italic;">#DBDBFF</span>
<span style="color: #000000;">8</span>  -<span style="color: #000000;">0.2141118</span>  <span style="color: #000000;">0.2141118</span> <span style="color: #666666; font-style: italic;">#FFFFFF</span>
<span style="color: #000000;">9</span>   <span style="color: #000000;">0.2141118</span>  <span style="color: #000000;">0.6423353</span> <span style="color: #666666; font-style: italic;">#FFDBDB</span>
<span style="color: #000000;">10</span>  <span style="color: #000000;">0.6423353</span>  <span style="color: #000000;">1.0705589</span> <span style="color: #666666; font-style: italic;">#FFB6B6</span>
<span style="color: #000000;">11</span>  <span style="color: #000000;">1.0705589</span>  <span style="color: #000000;">1.4987824</span> <span style="color: #666666; font-style: italic;">#FF9292</span>
<span style="color: #000000;">12</span>  <span style="color: #000000;">1.4987824</span>  <span style="color: #000000;">1.9270060</span> <span style="color: #666666; font-style: italic;">#FF6D6D</span>
<span style="color: #000000;">13</span>  <span style="color: #000000;">1.9270060</span>  <span style="color: #000000;">2.3552295</span> <span style="color: #666666; font-style: italic;">#FF4949</span>
<span style="color: #000000;">14</span>  <span style="color: #000000;">2.3552295</span>  <span style="color: #000000;">2.7834531</span> <span style="color: #666666; font-style: italic;">#FF2424</span>
<span style="color: #000000;">15</span>  <span style="color: #000000;">2.7834531</span>  <span style="color: #000000;">3.2116766</span> <span style="color: #666666; font-style: italic;">#FF0000</span>
y<span style="color: #7a0874; font-weight: bold;">&#91;</span>y <span style="color: #000000; font-weight: bold;">&</span>lt; <span style="color: #000000;">0.2141118</span> <span style="color: #000000; font-weight: bold;">&</span>amp; y -<span style="color: #000000;">0.2141118</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
 <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> -<span style="color: #000000;">0.105787824</span> -<span style="color: #000000;">0.016088927</span>  <span style="color: #000000;">0.073449451</span> -<span style="color: #000000;">0.147773797</span> -<span style="color: #000000;">0.048290296</span> -<span style="color: #000000;">0.104987809</span>
 <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">7</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> -<span style="color: #000000;">0.046166978</span> -<span style="color: #000000;">0.104987809</span> -<span style="color: #000000;">0.002299538</span>  <span style="color: #000000;">0.048313323</span>  <span style="color: #000000;">0.048313323</span>  <span style="color: #000000;">0.116084697</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">13</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>  <span style="color: #000000;">0.084641749</span>  <span style="color: #000000;">0.116084697</span>  <span style="color: #000000;">0.116084697</span> -<span style="color: #000000;">0.139204198</span> -<span style="color: #000000;">0.104987809</span>  <span style="color: #000000;">0.043834734</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">19</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> -<span style="color: #000000;">0.064813069</span> -<span style="color: #000000;">0.027849959</span>  <span style="color: #000000;">0.174754472</span> -<span style="color: #000000;">0.104987809</span>  <span style="color: #000000;">0.150884825</span> -<span style="color: #000000;">0.104987809</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">25</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>  <span style="color: #000000;">0.150884825</span> -<span style="color: #000000;">0.104987809</span> -<span style="color: #000000;">0.104987809</span> -<span style="color: #000000;">0.147773797</span> -<span style="color: #000000;">0.068730634</span>  <span style="color: #000000;">0.193457291</span>
<span style="color: #c20cb9; font-weight: bold;">which</span><span style="color: #7a0874; font-weight: bold;">&#40;</span>y <span style="color: #000000; font-weight: bold;">&</span>lt; <span style="color: #000000;">0.2141118</span> <span style="color: #000000; font-weight: bold;">&</span>amp; y -<span style="color: #000000;">0.2141118</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
 <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>   <span style="color: #000000;">6</span>  <span style="color: #000000;">30</span>  <span style="color: #000000;">41</span>  <span style="color: #000000;">64</span>  <span style="color: #000000;">71</span> <span style="color: #000000;">100</span> <span style="color: #000000;">110</span> <span style="color: #000000;">111</span> <span style="color: #000000;">115</span> <span style="color: #000000;">131</span> <span style="color: #000000;">142</span> <span style="color: #000000;">147</span> <span style="color: #000000;">151</span> <span style="color: #000000;">158</span> <span style="color: #000000;">169</span> <span style="color: #000000;">173</span> <span style="color: #000000;">221</span> <span style="color: #000000;">226</span> <span style="color: #000000;">229</span> <span style="color: #000000;">236</span> <span style="color: #000000;">237</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">22</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">243</span> <span style="color: #000000;">251</span> <span style="color: #000000;">254</span> <span style="color: #000000;">262</span> <span style="color: #000000;">265</span> <span style="color: #000000;">276</span> <span style="color: #000000;">284</span> <span style="color: #000000;">302</span> <span style="color: #000000;">347</span>
<span style="color: #666666; font-style: italic;">#以上数字式按先列后行的方式索引的，可能因为是用fortran实现的，因此不同于常见索引方式，</span>
<span style="color: #666666; font-style: italic;">#转换时使用(6-floor(6/nrow(y))*nrow(y), floor(6/nrow(y))+1)</span>
<span style="color: #c20cb9; font-weight: bold;">which</span><span style="color: #7a0874; font-weight: bold;">&#40;</span>y <span style="color: #000000; font-weight: bold;">&</span>lt; <span style="color: #000000;">0.2141118</span> <span style="color: #000000; font-weight: bold;">&</span>amp; y -<span style="color: #000000;">0.2141118</span>, arr.ind=TRUE<span style="color: #7a0874; font-weight: bold;">&#41;</span>
     row <span style="color: #c20cb9; font-weight: bold;">col</span>
drat   <span style="color: #000000;">6</span>   <span style="color: #000000;">1</span>
qsec   <span style="color: #000000;">8</span>   <span style="color: #000000;">3</span>
qsec   <span style="color: #000000;">8</span>   <span style="color: #000000;">4</span>
mpg    <span style="color: #000000;">9</span>   <span style="color: #000000;">6</span>
wt     <span style="color: #000000;">5</span>   <span style="color: #000000;">7</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">10</span>
disp  <span style="color: #000000;">11</span>  <span style="color: #000000;">10</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">11</span>
wt     <span style="color: #000000;">5</span>  <span style="color: #000000;">11</span>
hp    <span style="color: #000000;">10</span>  <span style="color: #000000;">12</span>
hp    <span style="color: #000000;">10</span>  <span style="color: #000000;">13</span>
carb   <span style="color: #000000;">4</span>  <span style="color: #000000;">14</span>
qsec   <span style="color: #000000;">8</span>  <span style="color: #000000;">14</span>
carb   <span style="color: #000000;">4</span>  <span style="color: #000000;">15</span>
carb   <span style="color: #000000;">4</span>  <span style="color: #000000;">16</span>
qsec   <span style="color: #000000;">8</span>  <span style="color: #000000;">16</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">21</span>
drat   <span style="color: #000000;">6</span>  <span style="color: #000000;">21</span>
mpg    <span style="color: #000000;">9</span>  <span style="color: #000000;">21</span>
wt     <span style="color: #000000;">5</span>  <span style="color: #000000;">22</span>
drat   <span style="color: #000000;">6</span>  <span style="color: #000000;">22</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">23</span>
mpg    <span style="color: #000000;">9</span>  <span style="color: #000000;">23</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">24</span>
mpg    <span style="color: #000000;">9</span>  <span style="color: #000000;">24</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">25</span>
cyl    <span style="color: #000000;">1</span>  <span style="color: #000000;">26</span>
mpg    <span style="color: #000000;">9</span>  <span style="color: #000000;">26</span>
wt     <span style="color: #000000;">5</span>  <span style="color: #000000;">28</span>
drat   <span style="color: #000000;">6</span>  <span style="color: #000000;">32</span>
转换索引（见上）</pre>
      </td>
    </tr>
  </table>
</div>

写道这儿发现自己还是挺悲剧的，为什么呢？看下面的内容，在heatmap.2函数的例子中已经实现了已上操作。

<div class="wp_codebox">
  <table>
    <tr id="p39223">
      <td class="code" id="p392code23">
        <pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#取出白色对应的区域</span>
<span style="color: #000000; font-weight: bold;">&</span>gt;colorTable<span style="color: #7a0874; font-weight: bold;">&#91;</span>hv<span style="color: #007800;">$colorTable</span><span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #ff0000;">"color"</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>==<span style="color: #ff0000;">"#FFFFFF"</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>
         low      high   color
<span style="color: #000000;">8</span> -<span style="color: #000000;">0.2141118</span> <span style="color: #000000;">0.2141118</span> <span style="color: #666666; font-style: italic;">#FFFFFF</span>
<span style="color: #666666; font-style: italic;">#取出白色对应的区域在原始矩阵中的值对。如在cyl中(5.805113, 6.569887)里面的值位于白色区域。</span>
whiteBin  whiteBin
       low       high
-<span style="color: #000000;">0.2141118</span>  <span style="color: #000000;">0.2141118</span>
rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>whiteBin<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">*</span> hv<span style="color: #007800;">$colSDs</span> + hv<span style="color: #007800;">$colMeans</span>, whiteBin<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">*</span> hv<span style="color: #007800;">$colSDs</span>+hv<span style="color: #007800;">$colMeans</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
          cyl        am        vs     carb       wt     drat     gear     qsec      mpg
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">5.805113</span> <span style="color: #000000;">0.2994102</span> <span style="color: #000000;">0.3295842</span> <span style="color: #000000;">2.466667</span> <span style="color: #000000;">3.007751</span> <span style="color: #000000;">3.482081</span> <span style="color: #000000;">3.529527</span> <span style="color: #000000;">17.46614</span> <span style="color: #000000;">18.80018</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">6.569887</span> <span style="color: #000000;">0.5130898</span> <span style="color: #000000;">0.5454158</span> <span style="color: #000000;">3.158333</span> <span style="color: #000000;">3.426749</span> <span style="color: #000000;">3.711044</span> <span style="color: #000000;">3.845473</span> <span style="color: #000000;">18.23136</span> <span style="color: #000000;">21.38107</span>
           hp     disp
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">132.0074</span> <span style="color: #000000;">204.1851</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000;">161.3676</span> <span style="color: #000000;">257.2586</span></pre>
      </td>
    </tr>
  </table>
</div>

3.在heatmap热图中标记每个单元格的内容  
[<img class="alignnone size-medium wp-image-1132" title="heatmap" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/heatmap-300x146.png" alt="" width="300" height="146" />][6]

<div class="wp_codebox">
  <table>
    <tr id="p39224">
      <td class="code" id="p392code24">
        <pre class="bash" style="font-family:monospace;">data<span style="color: #7a0874; font-weight: bold;">&#40;</span>mtcars<span style="color: #7a0874; font-weight: bold;">&#41;</span>
partb</pre>
      </td>
    </tr>
  </table>
</div>

4.densit-heatmap（差别在key）  
[<img class="alignnone size-medium wp-image-1135" title="densityHeat" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/densityHeat-300x234.png" alt="" width="300" height="234" />][7]

<div class="wp_codebox">
  <table>
    <tr id="p39225">
      <td class="code" id="p392code25">
        <pre class="bash" style="font-family:monospace;">rc</pre>
      </td>
    </tr>
  </table>
</div>

5.调节heatmap4部分的相对位置  
heatmap友4部分构成，第一部分（1）是中间的热图，第二部分（2）是行的树形图，第三部分（3）是列的树形图，第四部分（4）是key。

这个布局基于layout实现， 因此先介绍下基本的layout函数使用.

这里主要使用layout的mat参数（heatmap.2中是lmat），mat是一个矩阵对象，它用来指定输出设备上N个子图的位置。矩阵中的值必须为0或正整数。如果N是矩阵中最大的正整数， 那么所有从1到N的整数必须也要在矩阵中出现至少一次。图形I分配在它所出现的行和列区域。 其它参数见手册。

<div class="wp_codebox">
  <table>
    <tr id="p39226">
      <td class="code" id="p392code26">
        <pre class="bash" style="font-family:monospace;"><span style="color: #000000; font-weight: bold;">&</span>gt;matrix<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span>,<span style="color: #000000;">1</span>,<span style="color: #000000;"></span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>,<span style="color: #000000;">2</span>,<span style="color: #000000;">2</span>,<span style="color: #007800;">byrow</span>=TRUE<span style="color: #7a0874; font-weight: bold;">&#41;</span>
     <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;">1</span>    <span style="color: #000000;">1</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;"></span>    <span style="color: #000000;">2</span>
<span style="color: #000000; font-weight: bold;">&</span>gt;layout<span style="color: #7a0874; font-weight: bold;">&#40;</span>matrix<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span>,<span style="color: #000000;">1</span>,<span style="color: #000000;"></span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>,<span style="color: #000000;">2</span>,<span style="color: #000000;">2</span>,<span style="color: #007800;">byrow</span>=TRUE<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #000000; font-weight: bold;">&</span>gt;layout.show<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#给图形1指定第一行的全部（第一行的第一二列）</span>
<span style="color: #666666; font-style: italic;">#给图形2指定第二行的第二列，空出第一列</span></pre>
      </td>
    </tr>
  </table>
</div>

<div class="wp_codebox">
  <table>
    <tr id="p39227">
      <td class="code" id="p392code27">
        <pre class="bash" style="font-family:monospace;">rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">3</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>,c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">2</span>,<span style="color: #000000;">1</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
     <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;"></span>    <span style="color: #000000;">3</span>    <span style="color: #000000;">4</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;">2</span>    <span style="color: #000000;">1</span>    <span style="color: #000000;">4</span>
heatmap.2<span style="color: #7a0874; font-weight: bold;">&#40;</span>x, <span style="color: #007800;">lmat</span>=rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">3</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>,c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">2</span>,<span style="color: #000000;">1</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">lwid</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1.5</span>,<span style="color: #000000;">4</span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#Fig1, 在第二行第二列， Fig2在第二行第一列， Fig3在第一行第二列，Fig4在第三列，</span>
<span style="color: #666666; font-style: italic;">#即key在右侧【将右下角的4变为0，key就在右上角了】。</span>
rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">2</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
     <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">1</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;"></span>    <span style="color: #000000;">3</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">2</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;">2</span>    <span style="color: #000000;">1</span>
<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #000000;">3</span>,<span style="color: #7a0874; font-weight: bold;">&#93;</span>    <span style="color: #000000;"></span>    <span style="color: #000000;">4</span>
heatmap.2<span style="color: #7a0874; font-weight: bold;">&#40;</span>x, <span style="color: #007800;">lmat</span>=rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">2</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;"></span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">lhei</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1.5</span>,<span style="color: #000000;">4</span> , <span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#Fig2和1在第二行的左右两列，3在第一行右侧，4第三行第二列，key在下方</span>
heatmap.2<span style="color: #7a0874; font-weight: bold;">&#40;</span>x, <span style="color: #007800;">lmat</span>=rbind<span style="color: #7a0874; font-weight: bold;">&#40;</span>c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">4</span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">2</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">lhei</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1.5</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#仔细观察这个图和本文章最初的那个图，key和列树形图的位置差异。</span></pre>
      </td>
    </tr>
  </table>
</div>

[<img class="alignnone size-medium wp-image-1138" title="com_heatmap" src="http://210.75.224.29/wordpress/wp-content/uploads/2010/11/com_heatmap-300x85.png" alt="" width="300" height="85" />][8]  
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;

6.symnum的使用

<div class="wp_codebox">
  <table>
    <tr id="p39228">
      <td class="code" id="p392code28">
        <pre class="bash" style="font-family:monospace;">data<span style="color: #7a0874; font-weight: bold;">&#40;</span>USJudgeRatings<span style="color: #7a0874; font-weight: bold;">&#41;</span>
symnum<span style="color: #7a0874; font-weight: bold;">&#40;</span>cU</pre>
      </td>
    </tr>
  </table>
</div>

7.丰富颜色的使用

<div>
  <code>library</code><code>(</code><code>"RColorBrewer"</code><code>)</code>
</div>

<div>
  <code>heatmap</code><code>(data_matrix,col=</code><code>brewer.pal</code><code>(9,</code><code>"Blues"</code><code>))</code>
</div>

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;

bash脚本使用：

<div class="wp_codebox">
  <table>
    <tr id="p39229">
      <td class="code" id="p392code29">
        <pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#!/bin/bash</span>
&nbsp;
&nbsp;
usage<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #7a0874; font-weight: bold;">&#123;</span>
<span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">&</span>lt;<span style="color: #000000; font-weight: bold;">&</span>lt;EOF
<span style="color: #800000;">${txtcyn}</span>
Usage:
&nbsp;
<span style="color: #007800;">$0</span> options<span style="color: #800000;">${txtrst}</span>
&nbsp;
<span style="color: #800000;">${bldblu}</span>Function<span style="color: #800000;">${txtrst}</span>:
&nbsp;
This script is used to <span style="color: #000000; font-weight: bold;">do</span> clustring using heatmap.2.
&nbsp;
<span style="color: #800000;">${txtbld}</span>OPTIONS<span style="color: #800000;">${txtrst}</span>:
    -f    Data <span style="color: #c20cb9; font-weight: bold;">file</span> <span style="color: #7a0874; font-weight: bold;">&#40;</span>with header line, the first column is the
         colname, tab seperated<span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #800000;">${bldred}</span><span style="color: #7a0874; font-weight: bold;">&#91;</span>NECESSARY<span style="color: #7a0874; font-weight: bold;">&#93;</span><span style="color: #800000;">${txtrst}</span>
    -k    If the names of your rows and columns startwith numeric value,
        this can be <span style="color: #000000; font-weight: bold;">set</span> to FALSE to avoid modifying these names to be
        illegal variable names. But duplicates can not be picked out.
        <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${bldred}</span>Default TRUE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept FALSE.
    -t    Title of picture<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default empty title<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
    -x    xlab of picture<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default empty xlab<span style="color: #800000;">${txtrst}</span>. 
        If setted, using the words <span style="color: #c20cb9; font-weight: bold;">which</span> represents the 
        meaning of your columns<span style="color: #7a0874; font-weight: bold;">&#93;</span>
    -y    ylab of picture<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default empty ylab<span style="color: #800000;">${txtrst}</span>. 
        If setted, using the words <span style="color: #c20cb9; font-weight: bold;">which</span> represents the 
        meaning of your rows<span style="color: #7a0874; font-weight: bold;">&#93;</span>
    -r    row cluster<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${bldred}</span>Default TRUE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept FALSE.
    -c    <span style="color: #c20cb9; font-weight: bold;">col</span> cluster<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default FALSE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept TRUE.
    -s    row scale<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default FALSE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept TRUE.
    -w    <span style="color: #c20cb9; font-weight: bold;">col</span> scale<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default FALSE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept TRUE.
    -b    Add a vector <span style="color: #000000; font-weight: bold;">for</span> <span style="color: #7a0874; font-weight: bold;">break</span> points.<span style="color: #7a0874; font-weight: bold;">&#91;</span>Default heatmap.2 default.
        Accept <span style="color: #ff0000;">'0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.8,1'</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
    -z    Is there a header<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${bldred}</span>Default TRUE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept FALSE.
    -e    Execute or not<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${bldred}</span>Default TRUE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept FALSE.
    -a    Trace line<span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default none<span style="color: #800000;">${txtrst}</span>, choice column,
        none, row, both<span style="color: #7a0874; font-weight: bold;">&#93;</span>
    -d    Dendrom <span style="color: #7a0874; font-weight: bold;">&#91;</span><span style="color: #800000;">${txtred}</span>Default FALSE<span style="color: #800000;">${txtrst}</span><span style="color: #7a0874; font-weight: bold;">&#93;</span>
        Accept TRUE.
EOF
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
&nbsp;
<span style="color: #007800;">file</span>=
<span style="color: #007800;">checkNames</span>=<span style="color: #ff0000;">'TRUE'</span>
<span style="color: #007800;">title</span>=<span style="color: #ff0000;">''</span>
<span style="color: #007800;">xlab</span>=<span style="color: #ff0000;">''</span>
<span style="color: #007800;">ylab</span>=<span style="color: #ff0000;">''</span>
<span style="color: #007800;">row_C</span>=<span style="color: #ff0000;">'TRUE'</span>
<span style="color: #007800;">col_C</span>=<span style="color: #ff0000;">'FALSE'</span>
<span style="color: #007800;">rows</span>=<span style="color: #ff0000;">'FALSE'</span>
<span style="color: #007800;">cols</span>=<span style="color: #ff0000;">'FALSE'</span>
<span style="color: #007800;">break_v</span>=<span style="color: #ff0000;">" "</span>
<span style="color: #007800;">header</span>=<span style="color: #ff0000;">'TRUE'</span>
<span style="color: #007800;">execute</span>=<span style="color: #ff0000;">'TRUE'</span>
<span style="color: #007800;">trace</span>=<span style="color: #ff0000;">'none'</span>
<span style="color: #007800;">den</span>=<span style="color: #ff0000;">'FALSE'</span>
<span style="color: #000000; font-weight: bold;">while</span> <span style="color: #7a0874; font-weight: bold;">getopts</span> <span style="color: #ff0000;">"hf:k:t:x:y:r:c:s:w:b:z:e:a:d:"</span> OPTION
<span style="color: #000000; font-weight: bold;">do</span>
    <span style="color: #000000; font-weight: bold;">case</span> <span style="color: #007800;">$OPTION</span> <span style="color: #000000; font-weight: bold;">in</span>
        h<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            usage
            <span style="color: #7a0874; font-weight: bold;">exit</span> <span style="color: #000000;">1</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        f<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">file</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        k<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">checkNames</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        t<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">title</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        x<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">xlab</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        y<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">ylab</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        r<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">row_C</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        c<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">col_C</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        s<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">rows</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        <span style="color: #c20cb9; font-weight: bold;">w</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">cols</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        b<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">break_v</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        z<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">header</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        e<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">execute</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        a<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">trace</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        d<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            <span style="color: #007800;">den</span>=<span style="color: #007800;">$OPTARG</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
        ?<span style="color: #7a0874; font-weight: bold;">&#41;</span>
            usage
            <span style="color: #7a0874; font-weight: bold;">exit</span> <span style="color: #000000;">1</span>
            <span style="color: #000000; font-weight: bold;">;;</span>
    <span style="color: #000000; font-weight: bold;">esac</span>
<span style="color: #000000; font-weight: bold;">done</span>
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #007800;">$file</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    usage
    <span style="color: #7a0874; font-weight: bold;">exit</span> <span style="color: #000000;">1</span>
<span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
<span style="color: #666666; font-style: italic;">#midname='.Heatmap'</span>
<span style="color: #007800;">midname</span>=<span style="color: #ff0000;">''</span>
<span style="color: #007800;">scale</span>=
&nbsp;
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$rows</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #007800;">midname</span>=<span style="color: #ff0000;">'.RowScale'</span>
    <span style="color: #007800;">scale</span>=<span style="color: #ff0000;">'row'</span>
<span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$cols</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #800000;">${midname}</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #007800;">midname</span>=<span style="color: #800000;">${midname}</span><span style="color: #ff0000;">'.ColScale'</span>
    <span style="color: #000000; font-weight: bold;">else</span>
        <span style="color: #007800;">midname</span>=<span style="color: #800000;">${midname}</span><span style="color: #ff0000;">'.BothScale'</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #007800;">$scale</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #007800;">scale</span>=<span style="color: #ff0000;">'col'</span>
    <span style="color: #000000; font-weight: bold;">else</span>
        <span style="color: #007800;">scale</span>=<span style="color: #ff0000;">'both'</span>
    <span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #660033;">-z</span> <span style="color: #007800;">$scale</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #007800;">scale</span>=<span style="color: #ff0000;">'none'</span>
<span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
<span style="color: #007800;">dendrogram</span>=<span style="color: #ff0000;">'none'</span>
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&</span>amp;<span style="color: #000000; font-weight: bold;">&</span>amp; <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$col_C</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #007800;">dendrogram</span>=<span style="color: #ff0000;">'both'</span>
<span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #007800;">dendrogram</span>=<span style="color: #ff0000;">'row'</span>
<span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$col_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #007800;">dendrogram</span>=<span style="color: #ff0000;">'col'</span>
<span style="color: #000000; font-weight: bold;">fi</span>    
&nbsp;
<span style="color: #007800;">midname</span>=<span style="color: #800000;">${midname}</span><span style="color: #ff0000;">'.Heatmap'</span>
&nbsp;
<span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">&</span>lt;<span style="color: #000000; font-weight: bold;">&</span>lt;EOF <span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #007800;">$file</span><span style="color: #800000;">${midname}</span>.r
library<span style="color: #7a0874; font-weight: bold;">&#40;</span>graphics<span style="color: #7a0874; font-weight: bold;">&#41;</span>
data1 = read.table<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"<span style="color: #007800;">$file</span>"</span>, <span style="color: #007800;">header</span>=<span style="color: #007800;">$header</span>,
<span style="color: #007800;">sep</span>=<span style="color: #ff0000;">"<span style="color: #000099; font-weight: bold;">\t</span>"</span>,row.names=<span style="color: #000000;">1</span>, comment.char=<span style="color: #ff0000;">""</span>, check.names=<span style="color: #800000;">${checkNames}</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
x <span style="color: #000000; font-weight: bold;">&</span>lt;- as.matrix<span style="color: #7a0874; font-weight: bold;">&#40;</span>data1<span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #666666; font-style: italic;">#rc &lt;- rainbow(nrow(x), start=0, end=.3)</span>
<span style="color: #666666; font-style: italic;">#cc &lt;- rainbow(ncol(x), start=0, end=.3)</span>
library<span style="color: #7a0874; font-weight: bold;">&#40;</span>gplots<span style="color: #7a0874; font-weight: bold;">&#41;</span>
postscript<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">file</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${file}</span><span style="color: #007800;">${midname}</span>.eps"</span>, <span style="color: #007800;">onefile</span>=FALSE, <span style="color: #007800;">horizontal</span>=FALSE, 
    <span style="color: #007800;">paper</span>=<span style="color: #ff0000;">"special"</span>, <span style="color: #007800;">width</span>=<span style="color: #000000;">10</span>, height = <span style="color: #000000;">12</span>, <span style="color: #007800;">pointsize</span>=<span style="color: #000000;">10</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
break_v <span style="color: #000000; font-weight: bold;">&</span>lt;- c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">$break_v</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#40;</span>length<span style="color: #7a0874; font-weight: bold;">&#40;</span>break_v<span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #000000; font-weight: bold;">&</span>gt; <span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">&#41;</span> <span style="color: #7a0874; font-weight: bold;">&#123;</span>
&nbsp;
hv <span style="color: #000000; font-weight: bold;">&</span>lt;- heatmap.2<span style="color: #7a0874; font-weight: bold;">&#40;</span>x, <span style="color: #007800;">col</span>=greenred, <span style="color: #007800;">trace</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${trace}</span>"</span>, 
    <span style="color: #007800;">xlab</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$xlab</span>"</span>, <span style="color: #007800;">ylab</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$ylab</span>"</span>, <span style="color: #007800;">breaks</span>=break_v, 
    <span style="color: #007800;">main</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$title</span>"</span>, <span style="color: #007800;">margins</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">7</span>,<span style="color: #000000;">12</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">keysize</span>=<span style="color: #000000;">0.6</span>, <span style="color: #007800;">Rowv</span>=<span style="color: #800000;">${row_C}</span>,
    <span style="color: #007800;">Colv</span>=<span style="color: #800000;">${col_C}</span>, <span style="color: #007800;">dendrogram</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"<span style="color: #007800;">${dendrogram}</span>"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">scale</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"<span style="color: #007800;">$scale</span>"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
&nbsp;
<span style="color: #7a0874; font-weight: bold;">&#125;</span> <span style="color: #000000; font-weight: bold;">else</span> <span style="color: #7a0874; font-weight: bold;">&#123;</span>
hv <span style="color: #000000; font-weight: bold;">&</span>lt;- heatmap.2<span style="color: #7a0874; font-weight: bold;">&#40;</span>x, <span style="color: #007800;">col</span>=greenred<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">75</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">trace</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${trace}</span>"</span>, 
    <span style="color: #007800;">xlab</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$xlab</span>"</span>, <span style="color: #007800;">ylab</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$ylab</span>"</span>,
    <span style="color: #007800;">main</span>=<span style="color: #ff0000;">"<span style="color: #007800;">$title</span>"</span>, <span style="color: #007800;">margins</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">7</span>,<span style="color: #000000;">12</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">keysize</span>=<span style="color: #000000;">0.6</span>, <span style="color: #007800;">Rowv</span>=<span style="color: #800000;">${row_C}</span>,
    <span style="color: #007800;">Colv</span>=<span style="color: #800000;">${col_C}</span>, <span style="color: #007800;">dendrogram</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"<span style="color: #007800;">${dendrogram}</span>"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>, <span style="color: #007800;">scale</span>=c<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #ff0000;">"<span style="color: #007800;">$scale</span>"</span><span style="color: #7a0874; font-weight: bold;">&#41;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
<span style="color: #7a0874; font-weight: bold;">&#125;</span>
dev.off<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
EOF
&nbsp;
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">${den}</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&</span>amp;<span style="color: #000000; font-weight: bold;">&</span>amp; <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$col_C</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">&</span>lt;<span style="color: #000000; font-weight: bold;">&</span>lt;EOF <span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #007800;">$file</span><span style="color: #800000;">${midname}</span>.r
    postscript<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">file</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${file}</span><span style="color: #007800;">${midname}</span>.rowden.eps"</span>, <span style="color: #007800;">onefile</span>=FALSE, <span style="color: #007800;">horizontal</span>=FALSE, 
        <span style="color: #007800;">paper</span>=<span style="color: #ff0000;">"special"</span>, <span style="color: #007800;">width</span>=<span style="color: #000000;">10</span>, height = <span style="color: #000000;">12</span>, <span style="color: #007800;">pointsize</span>=<span style="color: #000000;">10</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv\<span style="color: #007800;">$rowDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    dev.off<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    postscript<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">file</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${file}</span><span style="color: #007800;">${midname}</span>.colden.eps"</span>, <span style="color: #007800;">onefile</span>=FALSE, <span style="color: #007800;">horizontal</span>=FALSE, 
        <span style="color: #007800;">paper</span>=<span style="color: #ff0000;">"special"</span>, <span style="color: #007800;">width</span>=<span style="color: #000000;">10</span>, height = <span style="color: #000000;">12</span>, <span style="color: #007800;">pointsize</span>=<span style="color: #000000;">10</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv\<span style="color: #007800;">$colDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    dev.off<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
EOF
    <span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">&</span>lt;<span style="color: #000000; font-weight: bold;">&</span>lt;EOF <span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #007800;">$file</span><span style="color: #800000;">${midname}</span>.r
    postscript<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">file</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${file}</span><span style="color: #007800;">${midname}</span>.rowden.eps"</span>, <span style="color: #007800;">onefile</span>=FALSE, <span style="color: #007800;">horizontal</span>=FALSE, 
        <span style="color: #007800;">paper</span>=<span style="color: #ff0000;">"special"</span>, <span style="color: #007800;">width</span>=<span style="color: #000000;">10</span>, height = <span style="color: #000000;">12</span>, <span style="color: #007800;">pointsize</span>=<span style="color: #000000;">10</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv\<span style="color: #007800;">$rowDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    dev.off<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
EOF
    <span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$col_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        <span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">&</span>lt;<span style="color: #000000; font-weight: bold;">&</span>lt;EOF <span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #000000; font-weight: bold;">&</span>gt;<span style="color: #007800;">$file</span><span style="color: #800000;">${midname}</span>.r
    postscript<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #007800;">file</span>=<span style="color: #ff0000;">"<span style="color: #007800;">${file}</span><span style="color: #007800;">${midname}</span>.colden.eps"</span>, <span style="color: #007800;">onefile</span>=FALSE, <span style="color: #007800;">horizontal</span>=FALSE, 
        <span style="color: #007800;">paper</span>=<span style="color: #ff0000;">"special"</span>, <span style="color: #007800;">width</span>=<span style="color: #000000;">10</span>, height = <span style="color: #000000;">12</span>, <span style="color: #007800;">pointsize</span>=<span style="color: #000000;">10</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    plot<span style="color: #7a0874; font-weight: bold;">&#40;</span>hv\<span style="color: #007800;">$colDendrogram</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
    dev.off<span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #7a0874; font-weight: bold;">&#41;</span>
EOF
    <span style="color: #000000; font-weight: bold;">fi</span>    
<span style="color: #000000; font-weight: bold;">fi</span>
&nbsp;
&nbsp;
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">${execute}</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    Rscript <span style="color: #007800;">$file</span><span style="color: #800000;">${midname}</span>.r
    <span style="color: #666666; font-style: italic;">#epstopdf ${file}${midname}.eps</span>
    convert <span style="color: #660033;">-density</span> <span style="color: #000000;">200</span> <span style="color: #660033;">-flatten</span> <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.eps <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.png
<span style="color: #666666; font-style: italic;">#-------------208-218---------</span>
<span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">${den}</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
    <span style="color: #000000; font-weight: bold;">if</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span> <span style="color: #000000; font-weight: bold;">&</span>amp;<span style="color: #000000; font-weight: bold;">&</span>amp; <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #007800;">$col_C</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        convert <span style="color: #660033;">-density</span> <span style="color: #000000;">200</span> <span style="color: #660033;">-flatten</span> <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.rowden.eps <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.rowden.png
        convert <span style="color: #660033;">-density</span> <span style="color: #000000;">200</span> <span style="color: #660033;">-flatten</span> <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.colden.eps <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.colden.png
    <span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$row_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        convert <span style="color: #660033;">-density</span> <span style="color: #000000;">200</span> <span style="color: #660033;">-flatten</span> <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.rowden.eps <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.rowden.png
    <span style="color: #000000; font-weight: bold;">elif</span> <span style="color: #7a0874; font-weight: bold;">&#91;</span> <span style="color: #ff0000;">"<span style="color: #007800;">$col_C</span>"</span> = <span style="color: #ff0000;">'TRUE'</span> <span style="color: #7a0874; font-weight: bold;">&#93;</span>; <span style="color: #000000; font-weight: bold;">then</span>
        convert <span style="color: #660033;">-density</span> <span style="color: #000000;">200</span> <span style="color: #660033;">-flatten</span> <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.colden.eps <span style="color: #800000;">${file}</span><span style="color: #800000;">${midname}</span>.colden.png
    <span style="color: #000000; font-weight: bold;">fi</span>    
<span style="color: #000000; font-weight: bold;">fi</span>
<span style="color: #666666; font-style: italic;">#-------------208-219---------</span>
<span style="color: #000000; font-weight: bold;">fi</span></pre>
      </td>
    </tr>
  </table>
</div>

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;  
**Deal with R outliers  
**

http://www.biostars.org/post/show/4802/r-heatmaps-log2-scale-or-non-log-scale/

http://dtrace.org/blogs/dap/2011/06/20/heatmap-coloring/

**不使用R**

使用[Multiple Array Viewer][9]

&nbsp;

&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;

http://stackoverflow.com/questions/6719747/heatmap-of-microarray-data-using-pearson-distance

http://comments.gmane.org/gmane.science.biology.informatics.conductor/36904

http://stats.stackexchange.com/questions/7183/increasing-row-height-in-r-heatmap-function

https://stat.ethz.ch/pipermail/r-help/2009-July/204016.html

https://stat.ethz.ch/pipermail/bioconductor/2011-October/041514.html

https://stat.ethz.ch/pipermail/bioconductor/2010-July/034512.html

 [1]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-41.png
 [2]: http://hosho.ees.hokudai.ac.jp/~kubo/Rdoc/library/gplots/html/heatmap.2.html
 [3]: http://cran.r-project.org/web/packages/gplots/gplots.pdf
 [4]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-5.png
 [5]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/Screenshot-6.png
 [6]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/heatmap.png
 [7]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/densityHeat.png
 [8]: http://210.75.224.29/wordpress/wp-content/uploads/2010/11/com_heatmap.png
 [9]: http://www.tm4.org/mev/?q=documentation/gaggle